import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from os import makedirs
from os.path import join

# cmap = sns.light_palette("seagreen", as_cmap=True)
# tab = [[0, 0.5, 1]]
# fig = plt.figure(figsize=(10, 6))
# ax = sns.heatmap(tab, cmap=cmap)
# fig.savefig('/home/gyutaek/hdd2/Results/scMamba/doublet figures(noticks,annot)/cmap.png', bbox_inches='tight', dpi=300)
# from ipdb import set_trace as st
# st()

# path_fig = '/home/gyutaek/hdd2/Results/scMamba/doublet figures(noticks,annot)/invivo'
# makedirs(path_fig, exist_ok=True)

# Lau = {
#     'Precision': [0.3794, 0.9634, 0.6564, 0.5649, 0.6689, 0.534, 0.9229, 0.94],
#     'Recall': [0.4357, 0.7183, 0.4445, 0.7297, 0.6557, 0.7985, 0.9139, 0.9257],
#     'TNR': [0.913, 0.9967, 0.9716, 0.9314, 0.9604, 0.9149, 0.9907, 0.9928],
#     'F1 score': [0.4056, 0.823, 0.53, 0.6368, 0.6622, 0.64, 0.9184, 0.9328],
#     'AUROC': [0.6815, 0.9501, 0.8744, 0.9096, 0.9128, 0.9242, 0.9941, 0.9953],
#     'AUPRC': [0.389, 0.8706, 0.5685, 0.6316, 0.6792, 0.9372, 0.9667, 0.9733]
# }

# Leng = {
#     'Precision': [0.1196, 0.918, 0.1681, 0.2515, 0.2831, 0.273, 0.8312, 0.7968],
#     'Recall': [0.1120, 0.3873, 0.2227, 0.5270, 0.4703, 0.5698, 0.722, 0.8893],
#     'TNR': [0.9515, 0.998, 0.9351, 0.9077, 0.9299, 0.9107, 0.9914, 0.9867],
#     'F1 score': [0.1157, 0.5447, 0.1916, 0.3405, 0.3534, 0.3692, 0.7728, 0.8405],
#     'AUROC': [0.4781, 0.8762, 0.7245, 0.788, 0.7784, 0.8158, 0.9723, 0.9839],
#     'AUPRC': [0.0985, 0.5796, 0.1464, 0.3759, 0.2712, 0.3812, 0.8416, 0.8803]
# }

# Smajic = {
#     'Precision': [0.0622, 0.2949, 0.0713, 0.1548, 0.1716, 0.0862, 0.9625, 0.9077],
#     'Recall': [0.0881, 0.1447, 0.2201, 0.4654, 0.4025, 0.3019, 0.4843, 0.7421],
#     'TNR': [0.9713, 0.9925, 0.9379, 0.945, 0.9579, 0.9307, 0.9996, 0.9984],
#     'F1 score': [0.0729, 0.1941, 0.1077, 0.2323, 0.2406, 0.1341, 0.6444, 0.8166],
#     'AUROC': [0.7161, 0.7136, 0.6376, 0.8113, 0.7433, 0.7015, 0.9564, 0.9936],
#     'AUPRC': [0.0773, 0.156, 0.0852, 0.239, 0.175, 0.0802, 0.7616, 0.9106]
# }

# Zhu = {
#     'Precision': [0.1486, 0.7291, 0.7253, 0.4655, 0.587, 0.4038, 0.6368, 0.5428],
#     'Recall': [0.2072, 0.6729, 0.4658, 0.8305, 0.7911, 0.7911, 0.9127, 0.9777],
#     'TNR': [0.9494, 0.9893, 0.9925, 0.9593, 0.9763, 0.9502, 0.9778, 0.9649],
#     'F1 score': [0.1731, 0.6999, 0.5673, 0.5966, 0.674, 0.5347, 0.7502, 0.698],
#     'AUROC': [0.6509, 0.893, 0.904, 0.9568, 0.9492, 0.9324, 0.989, 0.9921],
#     'AUPRC': [0.1713, 0.7026, 0.6087, 0.6985, 0.7567, 0.5336, 0.8864 ,0.8469]
# }

# Jung = {
#     'Precision': [None, 0.3871, 0.4658, 0.4963, 0.5535, 0.4934, 0.5904, 0.5408],
#     'Recall': [None, 0.4301, 0.3679, 0.4170, 0.4003, 0.481, 0.7963, 0.9389],
#     'TNR': [None, 0.8877, 0.9305, 0.9302, 0.9468, 0.9186, 0.9089, 0.8685],
#     'F1 score': [None, 0.4075, 0.4111, 0.4532, 0.4646, 0.4871, 0.6781, 0.6863],
#     'AUROC': [None, 0.7993, 0.8029, 0.8073, 0.8368, 0.803, 0.9407, 0.9616],
#     'AUPRC': [None, 0.58, 0.3957, 0.4536, 0.4732, 0.4755, 0.7439, 0.7992]
# }

# data_dict = {'Lau': Lau, 'Leng': Leng, 'Smajic': Smajic, 'Zhu': Zhu, 'Jung': Jung}

path_fig = '/home/gyutaek/hdd2/Results/scMamba/doublet figures(noticks,annot)/simulation'
makedirs(path_fig, exist_ok=True)

Lau = {
    'Precision': [0.4216, 0.954, 0.608, 0.3724, 0.5006, 0.3513, 0.728, 0.673],
    'Recall': [0.4219, 0.5066, 0.4244, 0.4302, 0.4334, 0.4697, 0.7332, 0.8327],
    'TNR': [0.9422, 0.9976, 0.9727, 0.9276, 0.9568, 0.9134, 0.9726, 0.9596],
    'F1 score': [0.4218, 0.6618, 0.4999, 0.3992, 0.4646, 0.402, 0.7306, 0.7443],
    'AUROC': [0.7918, 0.9151, 0.8887, 0.8414, 0.8871, 0.829, 0.9701, 0.9769],
    'AUPRC': [0.3903, 0.7234, 0.5075, 0.3248, 0.4508, 0.312, 0.8378, 0.8583]
}

Leng = {
    'Precision': [0.2986, 0.9692, 0.4098, 0.3362, 0.3962, 0.2737, 0.8788, 0.8081],
    'Recall': [0.2991, 0.3594, 0.4108, 0.4458, 0.4368, 0.4075, 0.5966, 0.7963],
    'TNR': [0.9299, 0.9989, 0.9409, 0.9121, 0.9335, 0.892, 0.9918, 0.9811],
    'F1 score': [0.2989, 0.5244, 0.4103, 0.3833, 0.4155, 0.3274, 0.7107, 0.8021],
    'AUROC': [0.7315, 0.8835, 0.8636, 0.8367, 0.8661, 0.7712, 0.9661, 0.9753],
    'AUPRC': [0.284, 0.6136, 0.3854, 0.326, 0.3925, 0.2748, 0.8274, 0.864]
}

Smajic = {
    'Precision': [0.1333, 0.944, 0.6027, 0.4994, 0.6264, 0.3954, 0.9907, 0.9098],
    'Recall': [0.1335, 0.5286, 0.5436, 0.5313, 0.5436, 0.3787, 0.579, 0.7698],
    'TNR': [0.9133, 0.9969, 0.9642, 0.9468, 0.9676, 0.9422, 0.9995, 0.9924],
    'F1 score': [0.1334, 0.6777, 0.5716, 0.5149, 0.5821, 0.3869, 0.7309, 0.8339],
    'AUROC': [0.7089, 0.946, 0.9047, 0.8823, 0.9263, 0.8082, 0.9734, 0.9842],
    'AUPRC': [0.1621, 0.7958, 0.6327, 0.4808, 0.6204, 0.3146, 0.8936, 0.9311]
}

Zhu = {
    'Precision': [0.1877, 0.859, 0.8415, 0.5614, 0.6841, 0.4637, 0.7291, 0.4996],
    'Recall': [0.1877, 0.6318, 0.4032, 0.4806, 0.4872, 0.55, 0.5975, 0.9021],
    'TNR': [0.9188, 0.9896, 0.9924, 0.9625, 0.9775, 0.9364, 0.9778, 0.9096],
    'F1 score': [0.1877, 0.7281, 0.5452, 0.5179, 0.5691, 0.5032, 0.6568, 0.6431],
    'AUROC': [0.6662, 0.9395, 0.9139, 0.8839, 0.924, 0.8415, 0.827, 0.9671],
    'AUPRC': [0.1936, 0.8009, 0.6735, 0.4901, 0.6438, 0.7251, 0.6845, 0.8325]
}

data_dict = {'Lau': Lau, 'Leng': Leng, 'Smajic': Smajic, 'Zhu': Zhu}

methods = ['DoubletFinder', 'DoubletDetection', 'cxds', 'bcds', 'hybrid', 'solo', 'scHyena', 'scMamba']

for data in data_dict.keys():
    df = pd.DataFrame(data_dict[data], index=methods)

    mask = df.isnull()

    fig = plt.figure(figsize=(10, 6))
    cmap = sns.light_palette("seagreen", as_cmap=True)
    ax = sns.heatmap(df, cmap=cmap, linewidths=0.5,  mask=mask, 
                vmin=0, vmax=1, linecolor='white', cbar=False, xticklabels=False, yticklabels=False, annot=True, fmt=".3f", annot_kws={"size": 20})
                # xticklabels=['Precision', 'Recall', 'TNR', 'F1 Score', 'AUROC', 'AUPRC'],
                # yticklabels=methods)
    # plt.xticks(fontsize=20, rotation=45)
    # plt.yticks(fontsize=20, rotation=0)
    fig.savefig(join(path_fig, data + '.png'), bbox_inches='tight', dpi=300)
